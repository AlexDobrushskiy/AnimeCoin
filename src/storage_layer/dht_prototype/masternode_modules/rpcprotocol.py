import json

MAX_VERSION_SUPPORTED = 1


def serialize(rpcname, data=None):
    json_packet = json.dumps({"rpcname": rpcname,
                       "version": MAX_VERSION_SUPPORTED,
                       "signature": None,
                       "timestamp": None,
                       "data": data,
                       "padding:": None})
    return json_packet.encode("utf-8")


def deserialize(packet):
    # TODO: enforce length limit
    packet_str = packet.decode("utf-8")
    packet = json.loads(packet_str)

    # TODO:
    # check signature
    # check version
    # check timestamp
    # check padding

    return packet["rpcname"], packet["data"]
