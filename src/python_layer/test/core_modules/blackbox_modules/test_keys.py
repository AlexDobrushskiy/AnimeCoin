import unittest
from unittest.mock import patch

from core_modules.blackbox_modules import keys

PRIVKEY = b'\xee\xb3\x9c\xc0\x86Ki\xe0\x19~\xb5\x11\xef\xe2\x04\xf2\xb3\xd5\x8b\xe4\x8a\xf9\xd6\xe6\'\x14\x9a\x94\xb5\xeb*\xa6\x809\x11\xfb\x06h\x8e\xe3\xafu\xa8\x08\xcf\xed\x9f\x1b\x97b"\x0f\xdaf\x08\xbbE\x8b\x0eNX\x82\xcd\xf3\x13\xa3\x9b\x03\xa2\x0c\xd0)o#\xc0<\xa9b<M\xd9\x81\x83Q\xa0\x8b\xd7\xdf\xc1\x07n\xf01\x1dQ+\xb5\xc4\x18\xe62\xd1q\x8bw\x05B\xa8.\xe8\\k\x05\x1e\x8f,\xc8\x7f\x9c\xe4\x02\xb6\xfb\x19\xa0\x1a\xeeY\xa9X\\\xfb\xf7\x07\x8b]\x15\x84\xa6d~\xaf]\x97\xc0\xb8\xecz\x11\xbd\xc5\x01\xc5\xe2\xb7\x82{=\xd3!\x86\xde\xc8\x9eM\x8bw=\xf1=\x8a\xb7Nk\xe1\x06L/y\xa4\xf7x\xf4\xae\xe7\xf0\x1b\xd3\xf5V\xbe\xb3\x81c\xc5\xbc*W \xf3\x91\xa3\x0eS\x99\xab"0\rJ@\x82\x9c(\x81&=\x11E\xd1\xca\x14bs\xd6\xe6\xcc\xdb\xe7\xe4PD} \x18\x12*\xe3Z\x8a\xb1P\x99\xd8\xa7\xb1\xafrAQ\xb5\x0cbx5v\xacJ\x1f\xd8\x89\xac\x04J\xec\x8e+\xdb@UH\xa5\xa7v\x0cq\xe0\x00\x84&\xae0\xcaC\xe5\xc4\x12X\xc1Q!Wv=[\x95\xb2\xc5\x91\x16-\'\xc4y$u\xec:\x97\xfe\x1d\x1b>\xdcN\xae\xdd\x87\x8b\xddq\xe7\xa8d{\x84$l\xa4&3B\xcd\xc5\xc5\x98R;\x11\x91\xa7\xa2\xa6\x7f\xbe\x9d=\n\xd6\xbb}\x06j\xcf.hc\xc5|\x839\xdea\x01\xb4L+\x0cvY*\x83I\xb6v\xbe?\xd7l\xa4z\x1d\xce\xa6\xbab\xa3~\x96M\xc6IZ\x8fT\xf9\xa1\x00\xfb\xc2@\xads\x98\xcf\xe8\xbe\xb0\\\x02\xa1J\x80E\x1d\x9a\xa5L\xbf\x0b\xd9\xa5\x00Xd 5\x0c\xc8\x00\x16\xa7\xb8\x19l\xc1\x1b\x14\xe1\x98\x85\xec3t\xcd\xb8]\xc1K\x10\x0e+ -X\xeb\xe1j\xe4\x18:\x07\xbe\x0c\xa9\xf5\xaaoEZ\x9c\xb8\x90L\x05bfFV\xcf\xeac\x89\nn\x12XU\xe1\xb7\xd8\xb9N\xccD\xacgO\x7f8\xbf\xbe\x9a\xef\xcd\x8e\xd8\xb9\xab\xbfp\x84\xfc\xc3\xa4y\x7f\x15a#\x1eL\x11)\xd9O[W\x81\xd9\t\x9f\xa8\x95^\x99\x87T\xe1\xa9\x16\xe2I\x15\x86rf\x9fI\x08\xe6\xbf\xf9M\xc9).\xb9\x96\xb4`y\x12\xaf\x11\xef\x19/\xa4\x8fc\xd3\x0c\xb4\x8e\xa5,\xeb\x1au\xc0\x91[\xee#\xa8{W\x05\xf5\xd3@\xeeu\xbcW\xe1\xb6\xc2;~\xe9\x03ll\x0e\x8e\xf0O\x94e\x05\xce1+\xe8\x8bL5\xf9ZpjH\'\xce\xb0G\xdf\xac\xef\xf1\xed+\xd6Q\xceB\xa8\xd4\xb7\xcb,\xd1\xd9\xa6\xdbYb\xa8\xdc\xc1\x1cKA\xf8\x89\xbaU\xe3\xed\xa8[\xae\x07\xfd\xb5\xe3z9\x86\xb5\x9b\x067DT\xf8\xb4*Kh\xe3\xa7\x19\xe7<\xdc\xd6C\xe1\x17\x82\xd4\xa9\x00i\x7f,{s\xa3G0*\xa7,r\x02y\xed\xf7TN\xc1\xac(\x1e\x9f-\xd6\xad\x00\x1b.\xa1\x076\x9a\xbc\x13M\x99\x12\xbdc\xce8\x89\xb8\xe5\xec\x0b\xbd%\x19\xef\xbc\x18\xad\x7f\xe7U^;\xbc\r\xfb2\x96\xaei\x08\xbau\x9d\xbb2\xc2\x86\xcf\x01\xaca3\xb3:\xda6\xfd\xa9U#c\x12))\xb8\xc7\xdd\xa8`\x16^\xbe7_\x82\x92Z\x0e\x87\x89P\xf5\x97Z\xe3B\xfbJ\x17\x1b\xf3\xc9\xe1\xbc@\x17\xd7\xb6\x16}\x87>\xfa\xb1B\xa0\x8e{\xa0\xf3\x0b\xa4\xa1\xdd\xde\x1e\x87n"%s6-\xf7bo\x82\x90\x97A\xf0b\xe3\xdcj[B\xd5\xf1D\x0e8\xfc\xfc\xc9 \xd9\xf9\x11\x8b!\xbbm!\xb5\x12P\xe0\x93\xe1:5\x1f\x9c\xb3\xa8\xf1\xf8R\xa3\x05e\x17\xe8\x811{\xd6\xd8J\xa8\xd7\x1a\xd4W\xc7\x90%@3@[\x04\x02\xa4f=\xa2h\x98\n\xf9\x95r\x8c\x1b&Z\xd5[\xd18o\x98S\x88\x05\xc1\xe0\xb3 \xad\x96:&0n\xa1\x1c"t\xe6\x1d4nb\x908\x92\xd5\xb6m\x93\x1ej\x00G\x9d\xf4\xe0\xaf\xb614$\xc3I\x8dy\xc0,\x19\x08\xed\x96\xa2\xd0\xc6-\xefg8@C\xdc\x08\xca\x0f5F\x1bV\x95\x10Z\xee,\xedk\x04\xa5\xb6\xdf\xdaj\x86\x91>\xb8\x80XL\x86*\xa7E\x93\xd2\xdb=\x10bjvL\x9a)c\xb8'
PUBKEY = b'\x1d\x04!T\xfe\x8c\xe7s/L#\x02)\xce\x07\x01\x9a\x8d\x85w\xb0\x95\xd1\xd9\x97I\xa8kH\xd3\x97\x95\xb5\xa5\x10\x10x\xe6\xf59\xe4o\xec\x18\x93}\xech\xbc\xc8>\xf6F\x9a[\xdf?"4bz\xd8\xc7`\xa3\x80'


class TestKeys(unittest.TestCase):
    @patch('nacl.utils.random', return_value=PRIVKEY)
    def test_key_generation(self, mock_method):
        privkey, pubkey = keys.id_keypair_generation_func()
        mock_method.assert_called_once_with(521*2)
        self.assertEqual(privkey, PRIVKEY)
        self.assertEqual(pubkey, PUBKEY)
