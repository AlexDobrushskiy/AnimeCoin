import unittest

from core_modules.blackbox_modules.crypto import get_Ed521
from core_modules.blackbox_modules.signatures import pastel_id_write_signature_on_data_func, \
    pastel_id_verify_signature_with_public_key_func


class TestSignatures(unittest.TestCase):
    def setUp(self):
        self.input_data = "THIS IS SOME TEST INPUT TEXT"
        self.Ed521 = get_Ed521()
        self.private_key = "E53D42827F8331B55CAE6D8E0E91F4C10BE5D12D34AA5B6ECDC48A0DDF45399DC717274DB6210AC481EE9017231831910D33B0957F58E8D4D7B8779329DA5D75BDADF40ADBFE55C95815389AF4AB57399912F51AA3975AFD468F3405B773889A99123C057D0AE6010CA0F73278E07A0F7C97E90CEFD099AC8FF0D66FE0AAB847B976DB0D7CA0107EDC59EA7CACCC047BD79116EA583368A342A9C9449D4797AC18FB6B676E689C30EC39FF80D3782F989B03091C814A3D32FB1AA68A47000820A9E45D68CB5C6BA5CAC4E2895532884CC91A4108964D5D278DACAE95C67D4EAD8B3AE19A8776CD536C62C0845AC9D50CA3E250B621B24141A364EA279EB1A412ED28B65F161EA02D467613830B1175A283B8046E2FBFAFD22A2F80EF07A94A34F974299F43C87E9FA0F24FD67E4F87164EAADE4B528AC01980DA3E921976DDB0E89B248C22541BBE7F30880EA404F74133296B2C573148AD813DF05E9E27F9A3538066C50F5C0C3851F8F49E1B9F76A87A5FEB35FFD414B4C9AB9377DB6CCC01BEAE5357ADDD0AA498F5CA03056A8C56A8F965306F08F845C27CA3DDE50243B782AE08F0CF0524269EE7F0EA19BFB793CC89E9F8AB46DE41ECD590A8B55F44D8EC9EEEB27E036ABF9F7DB52BC7D0E7AEC845CACF25ED404898C43A177191BDDB57FE07D7B55F4317D0664D188D2DFD4B63DA3353DAA01F20B3011F3B59744A768D0293A426D9C05242E26C1429E4F9F5C8FF441C5741DBDCEAC931A90B9B543B767AD9CF07166866FB8D163D2DECB3CE968FAB6696AD573266E9C5438AE224C1F870DBD7783EE619C94FAEE48E543D2323BA8170337FF2D73547A31D3D80BBB65317AA9D3608F2C02E5770E4A12989EF2F82E54E367D76134D246944965EA0B0BC1671D4786E9E1485FB4211A7C771C814A9C2B7527A4252EA65410B28C3A37E0FDD2EC6CA534465BCAC78CF92C3FD0ED8116C8CB6D371FEDD9A6C5107D43E48CBE4034E0914C49E42FCB4F9B85F08A424ABC24205D426239ABB843E43C38D7495902860FCFD25672960C180E6B1EF4BBE01E7D8A1DC33B36E5C89BA941882B0016917D70820158861E02FC7B8E2FFBD44FFD137DE0998EB922B233299E22B799BDEEB267A5340D176E64B2965A092584ABDD7175083DDCFFB89CA50C25F86FAFE3D8E779EBF9662A2E3132E203061A6BC9FE21D4C97A20E385A671F6BAC87F3D59369A588985A196340FC214A30CF1118D44E0A4CD9359FD2475B89B95C86B99FCCC4A7B3DA175D5DD52FE7A9394AAE7A979C4DDD750ADBC7D75C979AED707309CCC53CB10BB287C26E8A69F461723BFF71A1B3D4547ECB97D06E9D4781B9AD4D7172D038C3440A467936A725DCB14E9EC582C2CA42D75FD915176CD23057877CAF7DFD936981679533B917E85C3DF3BB00EEA2C52E0D277E93AFEA647C411961465BAFD968F6BF08E7EE99971B2D1AA541"
        self.public_key = "CE90F92D050951B34A9A59CBF79A836FDF6115679DE2B997EC370BC4BD8CD9E71657259D9A3F66D5345D4CB51192DD6FB92EEFA09CA984EFEE2B77018E48003D0E80"

    def test_signatures(self):
        signature = pastel_id_write_signature_on_data_func(self.input_data, self.private_key, self.public_key)
        verified = pastel_id_verify_signature_with_public_key_func(self.input_data, signature, self.public_key)
        self.assertTrue(verified)
